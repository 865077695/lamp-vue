webpackJsonp([12],{cgOO:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("G0Ko"),n=a("CIu9"),r=a("UMie"),i=a("SwQL"),c=a("7EUm"),o=a("pP4B"),l={name:"AlertNotice",components:{MyForm:s.a,MyPage:n.a},data:function(){var e=this;return{tableLoading:!1,switchDisabled:!1,msgListSearchItem:c.q,totalPage:null,msgSearchParams:{beginTime:null,endTime:null,streetId:null,poleSn:null,poleName:null,typ:null,deviceTyp:null,status:null,currentPage:1},msgList:[],columns:[{title:"消息id",key:"id"},{title:"报警时间",key:"time"},{title:"灯杆编号",key:"poleSn"},{title:"灯杆名称",key:"poleName"},{title:"设备类型",key:"deviceTyp",render:function(e,t){return Object(i.c)(t.row.deviceTyp,r.e.typeOptions)}},{title:"设备编号",key:"deviceSn"},{title:"消息内容",key:"content",render:function(e,t){var a=Object(i.c)(t.row.messageTyp,r.g);return 5===t.row.message&&(a+=t.row.content),a}},{title:"消息状态",key:"status",render:function(t,a){return t("i-switch",{props:{size:"large",trueValue:0,falseValue:1,value:a.row.status,disabled:e.switchDisabled},on:{"on-change":function(t){e.switchDisabled=!0,Object(o.a)({url:"/device/messageStatusEdit",params:{id:a.row.id,status:t}}).then(function(t){200===t.code?(e.switchDisabled=!1,e.$Message.success("修改成功")):(e.$Message.error("修改失败"),1===a.row.status?a.row.status=0:a.row.status=1)})}}},[t("span",{slot:"open"},"未看"),t("span",{slot:"close"},"已看")])}}]}},created:function(){this.getMsgList()},methods:{searchOk:function(){this.msgSearchParams.currentPage=1,this.getMsgList()},doValida:function(e){this.$refs[e].handleValida()},pageChange:function(){this.getMsgList()},getMsgList:function(){var e=this;this.tableLoading=!0,Object(o.a)({url:"/device/queryMessageList",method:"POST",data:this.msgSearchParams}).then(function(t){e.tableLoading=!1,200===t.code&&(e.msgList=t.data.result||[],e.totalPage=t.data.totalPage)})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search"},[a("my-form",{ref:"searchForm",staticClass:"searchForm",attrs:{formItems:e.msgListSearchItem,formData:e.msgSearchParams},on:{validaok:e.searchOk}}),e._v(" "),a("Button",{staticStyle:{height:"32px"},attrs:{type:"primary"},on:{click:function(t){e.doValida("searchForm")}}},[e._v("搜索")])],1),e._v(" "),a("Table",{staticClass:"table",attrs:{loading:e.tableLoading,border:"",columns:e.columns,data:e.msgList}}),e._v(" "),a("my-page",{attrs:{_totalPage:e.totalPage,_currentPage:e.msgSearchParams.currentPage},on:{pageChange:e.pageChange,"update:_currentPage":function(t){e.$set(e.msgSearchParams,"currentPage",t)}}})],1)},staticRenderFns:[]};var g=a("VU/8")(l,u,!1,function(e){a("eGjx")},"data-v-4544c82f",null);t.default=g.exports},eGjx:function(e,t){}});