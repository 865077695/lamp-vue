webpackJsonp([3],{KezN:function(e,a){},qoKT:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Dd8w"),n=t.n(i),r=t("O6e2"),d=t("pP4B"),s={name:"Tab",components:{MyPage:t("CIu9").a},props:{},data:function(){var e=this;return{tableLoading:!1,modal:!1,adding:!1,typ:1,currentPage:1,totalPage:1,queryMediaParams:{typ:null,name:null,currentPage:1},addMediaParams:{name:null,typ:null,file_name:null},updateMediaParams:{id:null,name:null},mediaList:[],templist:[],mediaInfo:null,columns:[{title:"资源id",key:"id"},{title:"文件名称",key:"name"},{title:"创建人",key:"user_name"},{title:"操作",key:"action",render:function(a,t){return a("div",[a("Poptip",{props:{confirm:!0,title:"您确定要删除这条数据吗?",transfer:!0},on:{"on-ok":function(){e.deleteMedia(t.row.id)}}},[a("Button",{style:{margin:"0 10px"},props:{type:"error",placement:"top",size:"small"}},"删除")])])}}],addRule:{name:[{required:!0,message:"该项为必填项",trigger:"blur"}],file_name:[{required:!0,message:"该项为必填项",trigger:"blur"}]}}},created:function(){var e=this;this.getMediaList(),this.getTempList(),r.a.$on("toggleTab",function(a){e.typ=Number(a),e.getMediaList({currentPage:1})})},methods:{query:function(){this.getMediaList({typ:this.typ,currentPage:1})},add:function(){this.modal=!0,this.addMediaParams={},this.getTempList()},ok:function(e){var a=this;this.$refs[e].validate(function(e){e?a.addMedia():a.$Message.error("参数格式错误！")})},cancel:function(){this.modal=!1},pageChange:function(){this.getMediaList()},getMediaList:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentPage:1};this.tableLoading=!0;var t={typ:this.typ,currentPage:this.queryMediaParams.currentPage,name:this.queryMediaParams.name};Object(d.a)({url:"media/list",method:"POST",data:n()({},a,t)}).then(function(a){e.tableLoading=!1,200===a.code?(e.mediaList=a.data.content,e.totalPage=a.data.totalPage):400===a.code&&(e.mediaList=null)})},addMedia:function(){var e=this;this.adding=!0;var a=n()({},this.addMediaParams,{typ:this.typ});Object(d.a)({url:"media/add",method:"POST",data:a}).then(function(a){e.adding=!1,200===a.code?(e.modal=!1,e.$Message.success("新增完成"),e.getMediaList()):e.$Message.error("失败，请重试")})},updateMedia:function(){var e=this,a=this.updateMediaParams;Object(d.a)({url:"media/update",method:"POST",data:a}).then(function(a){200===a.code&&e.$Message.success("修改完成")})},deleteMedia:function(e){var a=this;Object(d.a)({url:"media/delete",method:"POST",data:{ids:e}}).then(function(e){200===e.code&&(a.$Message.success("删除成功"),a.getMediaList({currentPage:1}))})},getTempList:function(){var e=this;Object(d.a)({url:"media/templist",method:"GET"}).then(function(a){200===a.code&&(e.templist=a.data)})},getMediaInfo:function(e){var a=this;Object(d.a)({url:"media/info",method:"POST",data:{ids:e}}).then(function(e){200===e.code&&(a.mediaInfo=e.data)})}}},o={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("Form",{ref:"queryMediaParams",attrs:{model:e.queryMediaParams,"label-width":80,inline:""}},[t("FormItem",{attrs:{label:"资源名称",prop:"name"}},[t("Input",{attrs:{placeholder:"资源名称"},model:{value:e.queryMediaParams.name,callback:function(a){e.$set(e.queryMediaParams,"name",a)},expression:"queryMediaParams.name"}})],1),e._v(" "),t("FormItem",[t("Button",{attrs:{type:"primary"},on:{click:function(a){e.query("queryMediaParams")}}},[e._v("查询")]),e._v(" "),t("Button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1)],1),e._v(" "),t("Modal",{attrs:{width:"400"},model:{value:e.modal,callback:function(a){e.modal=a},expression:"modal"}},[t("p",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("添加资源")])]),e._v(" "),t("div",{staticStyle:{"min-height":"100px","max-height":"500px",overflow:"auto"}},[t("Form",{ref:"addMediaParams",attrs:{model:e.addMediaParams,rules:e.addRule,"label-width":80,inline:""}},[t("FormItem",{attrs:{label:"资源名称",prop:"name"}},[t("Input",{attrs:{placeholder:"输入资源名称"},model:{value:e.addMediaParams.name,callback:function(a){e.$set(e.addMediaParams,"name",a)},expression:"addMediaParams.name"}})],1),e._v(" "),0!==e.templist.length?t("FormItem",{attrs:{label:"资源",prop:"file_name"}},[t("RadioGroup",{model:{value:e.addMediaParams.file_name,callback:function(a){e.$set(e.addMediaParams,"file_name",a)},expression:"addMediaParams.file_name"}},e._l(e.templist,function(e){return t("Radio",{key:e.fileName,staticClass:"radio-item",attrs:{label:e.fileName}})}))],1):e._e(),e._v(" "),0===e.templist.length?t("p",{staticStyle:{"padding-left":"80px"}},[e._v("请先通过FTP上传媒体资源")]):e._e()],1)],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"primary",size:"large",loading:e.adding},on:{click:function(a){e.ok("addMediaParams")}}},[e._v("提交")]),e._v(" "),t("Button",{attrs:{type:"default",size:"large"},on:{click:e.cancel}},[e._v("取消")])],1)]),e._v(" "),t("Table",{staticClass:"table",attrs:{loading:e.tableLoading,border:"",columns:e.columns,data:e.mediaList}}),e._v(" "),t("my-page",{attrs:{_totalPage:e.totalPage,_currentPage:e.queryMediaParams.currentPage},on:{pageChange:e.pageChange,"update:_currentPage":function(a){e.$set(e.queryMediaParams,"currentPage",a)}}})],1)},staticRenderFns:[]};var l={name:"MediaResource",components:{MyTab:t("VU/8")(s,o,!1,function(e){t("sSB5")},"data-v-dee4d82e",null).exports},data:function(){return{tab:"audio"}},methods:{toggleTab:function(e){r.a.$emit("toggleTab",e)}}},m={render:function(){var e=this.$createElement,a=this._self._c||e;return a("div",[a("Tabs",{attrs:{type:"card"},on:{"on-click":this.toggleTab}},[a("TabPane",{attrs:{label:"音频",icon:"music-note",name:"1"}}),this._v(" "),a("TabPane",{attrs:{label:"视频",icon:"videocamera",name:"2"}})],1),this._v(" "),a("my-tab")],1)},staticRenderFns:[]};var u=t("VU/8")(l,m,!1,function(e){t("KezN")},"data-v-a58d633a",null);a.default=u.exports},sSB5:function(e,a){}});