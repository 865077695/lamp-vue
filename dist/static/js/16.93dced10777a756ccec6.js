webpackJsonp([16],{bCws:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Gu7T"),s=a.n(r),o=a("Dd8w"),i=a.n(o),n=a("G0Ko"),d=a("CIu9"),l=a("7EUm"),c=a("pP4B"),u={name:"StreetAdmin",components:{MyForm:n.a,MyPage:d.a},data:function(){var t=this;return{tableLoading:!1,addModal:!1,adding:!1,streetListSearchItem:l.s,addStreetItem:l.j,addStreetFormRule:l.i,totalPage:null,streetSearchParams:{name:null,currentPage:1},addStreetData:{typ:1},streetsList:[],columns:[{title:"街道名称",key:"name"},{title:"心跳间隔",key:"heartbeat"},{title:"上报时间",key:"reporttime"},{title:"经度",key:"longitude"},{title:"纬度",key:"latitude"},{title:"定损功率",key:"power"},{title:"操作",key:"action",width:260,render:function(e,a){var r=[e("Button",{props:{type:"primary",size:"small"},style:{marginLeft:"20px"},on:{click:function(){t.$router.push({path:"/lamp-admin",query:{id:a.row.id,name:a.row.name}})}}},"灯杆管理"),e("Button",{props:{type:"primary",size:"small"},style:{marginLeft:"20px"},on:{click:function(){t.$router.push({path:"/lamp-group",query:i()({},a.row)})}}},"分组设置")],o=[e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.$router.push({path:"/street-edit",query:i()({},a.row)})}}},"编辑")];return"sys_admin"===t.roleType&&(r=[].concat(o,s()(r))),r}}]}},created:function(){this.getStreetsList()},activated:function(){this.getStreetsList()},computed:{roleType:function(){return console.log(this.$store.state.roleCode),this.$store.state.roleCode}},methods:{doValida:function(t){this.$refs[t].handleValida()},searchOk:function(){this.streetSearchParams.currentPage=1,this.getStreetsList()},addOk:function(){var t=this;this.adding=!0,Object(c.a)({url:"street/streetsAdd",method:"POST",data:this.addStreetData}).then(function(e){200===e.code&&(t.adding=!1,t.addModal=!1,t.$Message.success("成功"),t.addStreetData={typ:1},t.getStreetsList())})},add:function(){this.addModal=!0},cancel:function(){this.addStreetData={typ:1},this.addModal=!1},pageChange:function(){this.getStreetsList()},getStreetsList:function(){var t=this;this.tableLoading=!0,Object(c.a)({url:"street/streetsList",method:"POST",data:this.streetSearchParams}).then(function(e){t.tableLoading=!1,200===e.code&&(t.streetsList=e.data.streetsList,t.totalPage=e.data.totalPage)})}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"search"},[a("my-form",{ref:"searchForm",staticClass:"searchForm",attrs:{formItems:t.streetListSearchItem,formData:t.streetSearchParams},on:{validaok:t.searchOk}}),t._v(" "),a("Button",{staticStyle:{height:"32px"},attrs:{type:"primary"},on:{click:function(e){t.doValida("searchForm")}}},[t._v("搜索")]),t._v(" "),"addr_admin"!==t.roleType?a("Button",{staticStyle:{height:"32px","margin-left":"10px"},attrs:{type:"success"},on:{click:t.add}},[t._v("添加")]):t._e()],1),t._v(" "),a("Modal",{attrs:{width:"360"},model:{value:t.addModal,callback:function(e){t.addModal=e},expression:"addModal"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("添加街道")])]),t._v(" "),a("div",{staticStyle:{height:"400px"}},[a("my-form",{ref:"addForm",attrs:{formItems:t.addStreetItem,formData:t.addStreetData,formRule:t.addStreetFormRule},on:{validaok:t.addOk}})],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large",loading:t.adding},on:{click:function(e){t.doValida("addForm")}}},[t._v("提交")]),t._v(" "),a("Button",{attrs:{type:"default",size:"large"},on:{click:t.cancel}},[t._v("取消")])],1)]),t._v(" "),a("Table",{staticClass:"table",attrs:{loading:t.tableLoading,border:"",columns:t.columns,data:t.streetsList}}),t._v(" "),a("my-page",{attrs:{_totalPage:t.totalPage,_currentPage:t.streetSearchParams.currentPage},on:{pageChange:t.pageChange,"update:_currentPage":function(e){t.$set(t.streetSearchParams,"currentPage",e)}}})],1)},staticRenderFns:[]};var h=a("VU/8")(u,m,!1,function(t){a("zzIp")},"data-v-1a7692c4",null);e.default=h.exports},zzIp:function(t,e){}});